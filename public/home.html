<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Email Sender</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tinymce/5.10.0/tinymce.min.js"></script>

</head>

<body>
    <img class='loader' src="https://media.tenor.com/CY7LvPZrd-UAAAAj/circle-loading.gif" alt="" style="display: none;">

    <header>
        <h1>Mass Email Sender</h1>
        <p>Create and send personalized emails with ease.</p>
    </header>
    <!-- <h1>Mass Email Sender</h1> -->
    <div class="container">
        <a href="/" class="back-button">Home</a>

        <form action="/send-email" method="POST" enctype="multipart/form-data" onsubmit="showLoading()">
            <label for="file">Add personalization (please upload data in an excel file):</label>

        <form action="/send-email" method="POST" enctype="multipart/form-data">
            <label for="file">Add personalization</label>
            <p>Please upload data in an excel file (.xls, .xlsx)</p>

            <input type="file" name="file" id="fileInput" accept=".xlsx, .xls" onchange="readAndPrintEmailColumn()" >

            <div id="receiver-email">
                <label for="to">Recipient</label>
                <input type="text" id="to" name="to" required>
            </div>

            <label for="subject">Subject</label>
            <input type="text" name="subject" id="subject" required>

            <label for="message">Message</label>
            <div id="my-expressjs-tinymce-app-container">
                <textarea id="my-expressjs-tinymce-app" name="message" required>Please enter your message</textarea>
            </div>

            <label for="fileMaterial">Upload File</label>
            <input type="file" name="fileMaterial" id="fileMaterial"
                accept=".xlsx, .xls, .pdf, .doc, .docx" multiple>

            <label for="sender-email">Sender's Email</label>
            <input type="email" name="sender-email" id="sender-email" class="small-input" required>

            <label for="password" class="password-label">App specific Password</label>
            
            <div class="password-wrapper">
                <p><a href="app_password_instructions.html"
                    target="_blank" class="password-link">How to generate app-specific password?</a></p>
                <input type="password" name="password" id="password" class="small-input">
                <div class="show-password">
                    <input type="checkbox" id="password-toggle" class="large-checkbox"
                        onchange="togglePasswordVisibility()">
                    <label for="password-toggle" class="label-show-password">Show Password</label>
                </div>
            </div>

            <dialog id="message-dialog" class="message-dialog">
                <h2>Message Preview</h2>
                <div id="message-preview" class="message-preview"></div>
                <button id="close-dialog" onclick="closeMessageDialog()">Close</button>
            </dialog>
            <div class="buttons">
                <button type="button" class="get-started-button" onclick="openMessageDialog()">Preview Message</button>
                <button type="submit" class="get-started-button">Send Email</button>
            </div>
        </form>
    </div>
    <footer>
        &copy; 2023 Mass Email Sender. All rights reserved.
    </footer>
</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.4/xlsx.full.min.js"></script>
<script src="script.js"></script>
<!-- Script element sourcing TinyMCE -->
<script type="application/javascript" src="/tinymce/tinymce.min.js"></script>
<!-- Script element sourcing the TinyMCE configuration -->
<script type="application/javascript" src="/javascripts/my-tinymce-config.js"></script>

</html>